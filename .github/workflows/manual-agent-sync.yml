name: Manual System Agent Sync

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Target environment'
        required: true
        default: 'Production'
        type: choice
        options:
        - Production
        - Staging
      agent_ids:
        description: 'Specific agent IDs to sync (comma-separated, leave empty for all)'
        required: false
        type: string
      force_update:
        description: 'Force update even if versions match'
        required: false
        default: false
        type: boolean
      dry_run:
        description: 'Dry run (show what would be synced without making changes)'
        required: false
        default: false
        type: boolean

jobs:
  sync:
    name: Manual Agent Sync
    uses: ./.github/workflows/agent-sync-shared.yml
    with:
      environment: ${{ github.event.inputs.environment }}
      agent_ids: ${{ github.event.inputs.agent_ids }}
      force_update: ${{ github.event.inputs.force_update }}
      dry_run: ${{ github.event.inputs.dry_run }}
      backup_prefix: 'manual-agent-sync'
      skip_backup: false
    secrets: inherit